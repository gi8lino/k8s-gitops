{
    "$schema": "https://docs.renovatebot.com/renovate-schema.json",
    "semanticCommits": "enabled",
    "dependencyDashboard": true,
    "separateMajorMinor": false,
    "assignees": [
        "gi8lino"
    ],
    "regexManagers": [
        // dependencies for sync-cloudflare-nets
        {
            "fileMatch": [
                ".github\\/workflows\\/sync-cloudflare-nets\\.yaml$"
            ],
            "matchStrings": [
                "depName=(?<depName>.*)\\s.*\\/(?<currentValue>.*?)\\/"
            ],
            "datasourceTemplate": "github-releases"
        },
        // helm releases for apps, base & infra
        {
            "fileMatch": [
                "(apps|base|infra)\\/(.+\\/)*helmrelease\\.yaml$"
            ],
            "matchStrings": [
                "registryUrl=(?<registryUrl>.*?)\\s +chart: (?<depName>.*?)\\n +version: (?<currentValue>.*)"
            ],
            "datasourceTemplate": "helm"
        },
        // crd releases for k8up
        {
            "fileMatch": [
                "crds\\/k8up\\/kustomization\\.yaml$"
            ],
            "matchStrings": [
                "datasource=(?<datasource>.*) depName=(?<depName>.*)\\s.*\\/(?<currentValue>.*?)\\/"
            ]
        },
        // crd releases for cert-manager
        {
            "fileMatch": [
                "crds\\/cert-manager\\/kustomization\\.yaml$"
            ],
            "matchStrings": [
                "registryUrl=(?<registryUrl>.*?) chart=(?<depName>.*?)\\s.*\\/(?<currentValue>.*?)\\/"
            ],
            "datasourceTemplate": "helm"
        },
        // crd releases for kube-prometheus-stack
        {
            "fileMatch": [
                "crds\\/kube-prometheus-stack\\/crds\\.yaml$"
            ],
            "matchStrings": [
                "registryUrl=(?<registryUrl>.*)\\s.*tag: (?<depName>.*)-(?<currentValue>.*)"
            ],
            "datasourceTemplate": "helm"
        },
        // crd releases for traefik
        {
            "fileMatch": [
                "crds\\/traefik\\/crds\\.yaml$"
            ],
            "matchStrings": [
                "registryUrl=(?<registryUrl>.*) chart=(?<depName>.*)\\s.*tag: v(?<currentValue>.*)"
            ],
            "datasourceTemplate": "helm"
        }
    ],
    // image releases for traefik-forward-auth, apps & base
    "kubernetes": {
        "fileMatch": [
            "(infra\\/traefik\\/forward-auth|apps|base)\\/(.*\\/)*.+\\.yaml"
        ]
    },
    "packageRules": [
        {
            "matchDatasources": [
                "docker",
                "helm",
                "github-releases",
                "github-tags"
            ],
            "matchUpdateTypes": [
                "patch",
                "minor",
                "major"
            ],
            "labels": [
                "renovate/{{datasource}}",
                "dep/{{updateType}}"
            ],
            "enabled": true
        },
        // special versioning for linuxserver.io images
        {
            "matchDatasources": [
                "docker"
            ],
            "matchPackagePatterns": [
                "^lscr.io\\/linuxserver\\/.*"
            ],
            "versioning": "regex:^v?(?<major>\\d{1,3})\\.(?<minor>\\d+)\\.(?<patch>\\d+)(.*-ls)?(?<build>\\d+)$"
        }
    ],
    "pre-commit": {
        "enabled": true
    }
}
